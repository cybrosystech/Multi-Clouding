<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <report id="action_inv_tax_template_report"
                string="Invoice Tax Report"
                model="account.move"
                report_type="qweb-pdf"
                name="invoice_tax_report.inv_tax_report"
                file="invoice_tax_report.inv_tax_report"
        />

        
        <record id="action_inv_tax_template_report" model="ir.actions.report">
            <field name="paperformat_id" ref="invoice_tax_report.paperformat_inv_tax_template_report"/>
            <field name="print_report_name">(object._get_report_base_filename())</field>
        </record>
        <template id="invoice_tax_report.inv_tax_report">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="invoice_tax_report.report_inv_tax_document_order" t-lang="doc.partner_id.lang"/>
                </t>
            </t>
        </template>
        <template id="report_inv_tax_document_order">
            <t t-call="invoice_tax_report.external_layout_inv_tax_template">
                <t t-set="doc" t-value="doc.with_context({'lang':doc.partner_id.lang})"/>
                <div class="page">
                    <div class="oe_structure"/>
                    <p style="text-align:center;font-weight:bold;font-size:18px;">Tax Invoice</p>
                    <div class="row">
                        <div class="col-6">
                            <div>
                                <span style="font-weight:bold" >Bill To:</span>
                            </div>
                            <div>
                                <span t-field="doc.partner_id" t-options='{"widget": "contact", "fields": ["address"]}'/>
                            </div>

                            <div>
                                <span style="font-weight:bold" >Tax ID:</span>
                                <span t-field="doc.partner_id.vat"/>
                            </div>
                        </div>

                        <div class="col-6">
                            <div>
                                <span style="font-weight:bold" >Invoice Date:</span>
                                <span t-field="doc.invoice_date"/>
                            </div>
                            <div>
                                <span style="font-weight:bold" > Invoice No.:</span>
                                <span t-field="doc.name"/>
                            </div>
                            <div>
                                <span style="font-weight:bold" >Service Date:</span>
                                <span t-field="doc.payment_reference"/>
                            </div>

                        </div>

                </div>

                     <style>
                        .custom_table_lines thead th, .custom_table_lines tbody td{
                        border: 2px solid #636161;
                        padding: 5px;
                        }
                        .custom_table_lines thead th{
                        background: #ccc;
                        color: #636161;
                        }
                        .box{
                        width: 100%;
                        border: 1px solid #ccc !important;
                        margin-bottom: 10px;
                        padding: 5px;
                        }
                        .totals_box{
                        border: 1px solid #ccc !important;
                        margin-bottom: 10px;
                        padding: 5px;
                        float: right;
                        width: 25%;
                        }
                        .totals_box{
                        width: 25%;
                        position: relative;
                        right: 0;
                        }
                        .totals_amount_line{
                            padding: 40px 20px;
                        }
                    </style>
                    <br/>
                    <table class="custom_table_lines" width="100%">
                        <thead>
                            <tr>
                                <th>No.</th>
                                <th>Service Description</th>
                                <th>Qty</th>
                                <th>Rate <t t-esc="doc.currency_id.name"/></th>
                                <th>Total Amount <t t-esc="doc.currency_id.name"/></th>
                                <th>Exchange rate</th>
                                <th>Total Amount AED</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="line_index" t-value="0"/>

                            <t t-foreach="doc.invoice_line_ids" t-as="line">
                                <tr>
                                    <td>
                                        <span t-set="line_index" t-value="line_index+1"/>

                                        <span t-esc="line_index"/>
                                    </td>
                                    <td>
                                        <span t-esc="line.name"/>
                                    </td>
                                    <td>
                                        <span t-esc="line.quantity"/>
                                    </td>
                                    <td>
                                        <span t-field="line.price_unit"/>
                                    </td>


                                    <td>
                                        <span t-esc="line.price_subtotal"/>
                                    </td>
                                    <td>
                                        <span t-esc="line.new_rate"/>
                                    </td>

                                    <td>
                                        <span t-esc="line.subtotal_local_amount"/>
                                    </td>

                                </tr>
                            </t>

                        </tbody>
                        <tr style="border:0px">
                            <td style="border:0px" colspan="5" class="text-right">
                                <span style="font-weight:bold">Total Excluding VAT</span><br/>

                                <span style="font-weight:bold"><span t-esc="', '.join(map(lambda x: (x.description or x.name), doc.invoice_line_ids.mapped('tax_ids')))"/></span><br/>
                                <span style="font-weight:bold">Total Including VAT</span>
                            </td>
                            <td style="border:0px" >
                                <span style="font-weight:bold" t-esc="doc.amount_untaxed"></span><br/>

                                <span style="font-weight:bold" t-esc="doc.amount_tax"></span><br/>
                                <span style="font-weight:bold" t-esc="doc.amount_total"></span>
                            </td>
                            <td style="border:0px" >
                                <span style="font-weight:bold" t-esc="doc.subtotal_local_amount"  ></span><br/>
                                <span style="font-weight:bold" t-esc="doc.local_tax_amount" ></span><br/>
                                <span style="font-weight:bold" t-esc="doc.total_local_amount" ></span>
                            </td>
                        </tr>

                    </table>
                    <t t-foreach="range(10-len(doc.invoice_line_ids))" t-as="l">
                        <br/>
                    </t>
                    <div class="row" style="page-break-inside: avoid !important;">
                        <div class="col-12" >
                            <span>
                               <span style="text-decoration:underline;font-weight:bold">BANK DETAIL :</span>
                                <br/>
                                Transfer the amount to the business account below.<br/>
                                Please remit payment by electronic transfer to the following account, quoting the invoice number as the reference:<br/>
                                Bank Name : First Abu Dhabi Bank<br/>
                                Bank Account Name : TASC Towers Holding Limited<br/>
                                Bank Account Number : 100-100-4115781-02-6<br/>
                                IBAN Number : AE-06-035-100-100-4115781-02-6<br/>
                                SWIFT: FGBMAEAA<br/>
                            </span>
                        </div>
                    </div>


                </div>
            </t>
        </template>


    </data>
</odoo>