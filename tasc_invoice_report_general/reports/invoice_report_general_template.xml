<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="action_invoice_general_template_report"
            model="ir.actions.report">
        <field name="name">Tasc Invoice Report (General)</field>
        <field name="model">account.move</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">tasc_invoice_report_general.invoice_general_report</field>
        <field name="report_file">tasc_invoice_report_general.invoice_general_report</field>
        <field name="paperformat_id"
               ref="tasc_invoice_report_general.paperformat_inv_general_template_report"/>
        <field name="binding_model_id" ref="account.model_account_move"/>
        <field name="print_report_name">(object._get_report_base_filename())
        </field>
    </record>

    <template id="report_invoice_general_document_order">
        <t t-call="tasc_invoice_report_general.external_layout_inv_general_template">
            <t t-set="doc"
               t-value="doc.with_context({'lang':doc.partner_id.lang})"/>
            <div class="page">
                <div class="oe_structure"/>
                <t t-if="doc.move_type in ['out_refund', 'in_refund']">
                    <p style="text-align:center;font-weight:bold;font-size:18px;">
                        Credit Note
                    </p>
                </t>
                <t t-else="">
                    <p style="text-align:center;font-weight:bold;font-size:18px;">
                        Invoice
                    </p>
                </t>
                <div class="row">
                    <div class="col-6">
                        <div>
                            <span style="font-weight:bold">Invoice Date:
                            </span>
                            <span t-field="doc.invoice_date"/>
                        </div>
                        <div>
                            <span style="font-weight:bold">Invoice #:
                            </span>
                            <span t-field="doc.payment_reference"/>
                        </div>
                        <div>
                            <span style="font-weight:bold">Bill To:</span>
                            <span t-field="doc.partner_id"
                            />
                        </div>
                        <!--                        <div>-->
                        <!--                            -->
                        <!--                        </div>-->


                    </div>
                    <div class="col-6">
                        <div>
                            <span style="font-weight:bold">Tax ID:</span>
                            <span t-field="doc.company_id.vat"/>
                        </div>
                        <div>
                            <t t-if="doc.invoice_payment_term_id">
                                <span style="font-weight:bold">Payment
                                    Terms:
                                </span>
                                <span t-field="doc.invoice_payment_term_id.name"/>
                            </t>
                            <t t-else="">
                                <span style="font-weight:bold">Due Date:
                                </span>
                                <span t-field="doc.invoice_date_due"/>
                            </t>
                        </div>
                        <!--                        <div>-->
                        <!--                            <span style="font-weight:bold">Reference:-->
                        <!--                            </span>-->
                        <!--                            <span t-field="doc.payment_reference"/>-->
                        <!--                        </div>-->
                    </div>
                </div>
                <style>
                    .custom_table_lines thead th, .custom_table_lines tbody
                    td{
                    text-align:left;

                    border: 2px solid #636161;
                    padding: 5px;
                    }
                    .custom_table_lines thead th{
                    background: #ccc;
                    color: #636161;
                    }
                    .box{
                    width: 100%;
                    border: 1px solid #ccc !important;
                    margin-bottom: 10px;
                    padding: 5px;
                    }
                    .totals_box{
                    border: 1px solid #ccc !important;
                    margin-bottom: 10px;
                    padding: 5px;
                    float: right;
                    width: 25%;
                    }
                    .totals_box{
                    width: 25%;
                    position: relative;
                    right: 0;
                    }
                    .totals_amount_line{
                    padding: 40px 20px;
                    }
                </style>
                <br/>
                <div>
                    <table class="custom_table_lines" width="100%">
                        <thead>
                            <tr>
                                <th>No.</th>
                                <th>Description</th>
                                <th>Qty</th>
                                <th>Unit price
                                </th>
                                <th>Total Amount (<t
                                        t-esc="doc.currency_id.name"/>)
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="line_index" t-value="0"/>
                            <t t-foreach="doc.invoice_line_ids" t-as="line">
                                <tr>
                                    <td>
                                        <span t-set="line_index"
                                              t-value="line_index+1"/>

                                        <span t-esc="line_index"/>
                                    </td>
                                    <td>
                                        <span t-esc="line.name"/>
                                    </td>
                                    <td>
                                        <span t-esc="line.quantity"/>
                                    </td>
                                    <td>
                                        <span t-field="line.price_unit"/>
                                    </td>
                                    <td>
                                        <span t-esc="line.price_subtotal"/>
                                    </td>
                                </tr>
                            </t>
                            <tr>
                                <td colspan="4"
                                    style="font-weight:bold;text-align:center;">
                                    Sub Total
                                </td>
                                <td>
                                    <t t-set="amount_untaxed"
                                       t-value="'{:20,.2f}'.format(doc.amount_untaxed)"/>
                                    <span t-esc="doc.currency_id.symbol"/>
                                    <span style="font-weight:bold"
                                          t-esc="'{:20,.2f}'.format(doc.amount_untaxed)"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4" style="text-align:center;">
                                    <span style="font-weight:bold">
                                        <span t-esc="', '.join(map(lambda x: 'Tax ' + x.name, set(doc.invoice_line_ids.mapped('tax_ids')))) if doc.invoice_line_ids.mapped('tax_ids') else 'Tax'"/>
                                    </span>
                                </td>
                                <td>
                                    <span t-esc="doc.currency_id.symbol"/>
                                    <span style="font-weight:bold"
                                          t-esc="'{:20,.2f}'.format(doc.amount_tax)"/>

                                </td>
                            </tr>
                            <tr>
                                <td colspan="4"
                                    style="font-weight:bold;text-align:center;">
                                    Total Amount Due
                                </td>
                                <td>
                                    <span t-esc="doc.currency_id.symbol"/>
                                    <span style="font-weight:bold"
                                          t-esc="'{:20,.2f}'.format(doc.amount_total)"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="5"
                                    style="font-weight:bold;text-align:center;">
                                    <span t-out="doc.currency_id.with_context(lang='en_US').amount_to_text(doc.amount_total)"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="row" style="margin-top: 6rem;">
                    <div class="col-12">
                        <span>
                            Please remit the amount to the below account
                            details:
                            <br/>
                            Beneficiary Name :
                            <t t-esc="doc.company_id.name"/>
                            <br/>
                            Bank Name :
                            <t t-esc="doc.company_id.bank_name"/>
                            <br/>
                            Bank Account Number :
                            <t t-esc="doc.company_id.short_code"/>
                            <br/>
                            IBAN :
                            <t t-esc="doc.company_id.iban"/>
                            <br/>
                            SWIFT:
                            <t t-esc="doc.company_id.swift"/>
                            <br/>
                        </span>
                    </div>
                </div>
                <br/><br/><br/><br/>
                <div class="row  justify-content-end">
                    <t style="font-weight:bold" t-esc="doc.company_id.name"/>
                </div>
                <div class="row justify-content-end" >
                        <img t-if="doc.company_id.company_stamp"
                             class="float-right"
                             style="max-width: 100%; height: 70px;"
                             t-att-src="image_data_uri(doc.company_id.company_stamp)"
                             alt="Stamp"/>
                </div>

                <div class="row"
                     style="position:fixed;top:1100px;line-break:avoid;width:1000px;">
                    <div class="col-lg">
                        <t t-if="doc.move_type in ['out_refund', 'in_refund']">
                            <span style="font-weight:bold;">This is an
                                automated
                                Credit Note and no signature required.
                            </span>
                        </t>
                        <t t-else="">
                            <span style="font-weight:bold;">This is an
                                automated
                                invoice and no signature required.
                            </span>

                        </t>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="tasc_invoice_report_general.invoice_general_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="tasc_invoice_report_general.report_invoice_general_document_order"
                   t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>


</odoo>